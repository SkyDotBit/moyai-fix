(function(m,t,v,r,T,s){"use strict";const{ScrollView:D}=s.General,{FormSwitchRow:E}=s.Forms,{View:g}=r.ReactNative;function I(){return T.useProxy(t.storage),React.createElement(React.Fragment,null,React.createElement(D,{style:{flex:1}},React.createElement(E,{label:"Play on reactions :O",value:t.storage.allowReactions??!0,onValueChange:function(e){t.storage.allowReactions=e},style:{marginBottom:20,marginTop:20}}),React.createElement(g,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(s.Forms.FormInput,{title:"\u{1F5FF} Custom Sound URL",placeholder:"https://github.com/SkyDotBit/moyai-fix/raw/refs/heads/main/thud.mp3",onChangeText:function(e){return t.storage.customUrl=e},style:{marginTop:20,marginHorizontal:12,marginVertical:10}}),React.createElement(g,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(s.Forms.FormInput,{title:"\u{1F5FF} Custom emoji (Does not support Nitro emojis/FreeNitro emojis)",placeholder:"\u{1F5FF}",onChangeText:function(e){return t.storage.customEmoji=e},style:{marginTop:20,marginHorizontal:12,marginVertical:10}}),React.createElement(g,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(E,{label:"Ignore silent mode",value:t.storage.ignoreSilent??!1,onValueChange:function(e){t.storage.ignoreSilent=e},style:{marginBottom:20}})))}const{DCDSoundManager:o}=r.ReactNative.NativeModules,F=v.findByStoreName("SelectedChannelStore");if(t.storage.ignoreSilent??!1)try{o.setCategory("Playback",!0)}catch(e){console.error(e+"This is an old version of the code thing please know that this is not something you should worry about I was just too lazy to remove it - Sky.Bit")}const h=6969;let j=-1,d="https://github.com/SkyDotBit/moyai-fix/raw/refs/heads/main/thud.mp3";t.storage.customUrl&&(d=t.storage.customUrl);let f="\u{1F5FF}";t.storage.customEmoji&&(f=t.storage.customEmoji);const i=6969;let S=-1;const R=function(){return new Promise(function(e){console.log("Hi"),t.storage.ignoreSilent??!1?o.prepare(d,"vibing_wumpus",i,function(n,a){n&&console.error(n),e(a)}):o.prepare(d,"notification",i,function(n,a){return e(a)})})};let y=null,c=!1;async function A(){c&&(y!=null&&clearTimeout(y),o.stop(i),c=!1),c=!0,await o.play(i),setTimeout(function(){c=!1,o.stop(i),y=null},S)}let l=null,u=!1;async function _(){u&&(l!=null&&clearTimeout(l),o.stop(h),u=!1),u=!0,await o.play(h),l=setTimeout(function(){u=!1,o.stop(h),l=null},j)}function b(){R(),t.storage.ignoreSilent??!1?_():A()}function C(e){if(e.message.content&&e.channelId==F.getChannelId()&&!e.message.state&&e.sendMessageOptions==null){let n=(e.message.content.match(f)??[]).length;if(n+=(e.message.content.match(/<a?:.*?moy?ai.*?:.+?>/gi)??[]).length,n>0)for(let a=0;a<n;a++)setTimeout(b,a*350)}}function p(e){(t.storage.allowReactions??!0)&&e.channelId==F.getChannelId()&&(e.emoji.name==f||e.emoji.name.match(/.*?moy?ai.*?/i))&&!e.optimistic&&b()}let w=!1;var x={onLoad:function(){w||R().then(function(e){w=!0,S=e.duration}),r.FluxDispatcher.subscribe("MESSAGE_CREATE",C),r.FluxDispatcher.subscribe("MESSAGE_REACTION_ADD",p)},onUnload:function(){r.FluxDispatcher.unsubscribe("MESSAGE_CREATE",C),r.FluxDispatcher.unsubscribe("MESSAGE_REACTION_ADD",p)},settings:I};return m.default=x,Object.defineProperty(m,"__esModule",{value:!0}),m})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.storage,vendetta.ui.components);
