(function(l,t,b,a,C,r){"use strict";const{FormText:p}=r.Forms,{ScrollView:w}=r.General,{FormSwitchRow:d}=r.Forms,{View:u}=a.ReactNative;function D(){return C.useProxy(t.storage),React.createElement(React.Fragment,null,React.createElement(w,{style:{flex:1}},React.createElement(d,{label:"Play on reactions :O",value:t.storage.allowReactions??!0,onValueChange:function(e){t.storage.allowReactions=e},style:{marginBottom:20,marginTop:20}}),React.createElement(u,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(r.Forms.FormInput,{title:"\u{1F5FF} Custom Sound URL",placeholder:"https://github.com/SkyDotBit/moyai-fix/raw/refs/heads/main/thud.mp3",onChangeText:function(e){return t.storage.customUrl=e},style:{marginTop:20,marginHorizontal:12,marginVertical:10}}),React.createElement(u,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(r.Forms.FormInput,{title:"\u{1F5FF} Custom emoji (Does not support Nitro emojis/FreeNitro emojis)",placeholder:"\u{1F5FF}",onChangeText:function(e){return t.storage.customEmoji=e},style:{marginTop:20,marginHorizontal:12,marginVertical:10}}),React.createElement(u,{style:{height:1,backgroundColor:"#ccc",marginVertical:10}}),React.createElement(d,{label:"Ignore silent mode",value:t.storage.ignoreSilent??!1,onValueChange:function(e){t.storage.ignoreSilent=e},style:{marginBottom:20}}),React.createElement(p,{style:{marginTop:20}},"You will need to restart Discord, disable then enable the plugin, or refetch the plugin for changes to take place.")))}const{DCDSoundManager:n}=a.ReactNative.NativeModules,f=b.findByStoreName("SelectedChannelStore");if(t.storage.ignoreSilent??!1)try{n.setCategory("Playback",!0)}catch(e){console.error(e+"This is an old version of the code thing please know that this is not something you should worry about I was just too lazy to remove it - Sky.Bit")}let m="https://github.com/SkyDotBit/moyai-fix/raw/refs/heads/main/thud.mp3";t.storage.customUrl&&(m=t.storage.customUrl);let g="\u{1F5FF}";t.storage.customEmoji&&(g=t.storage.customEmoji);const i=6969;let y=-1;const T=function(){return new Promise(function(e){console.log("Hi"),t.storage.ignoreSilent??!1?n.prepare(m,"music",i,function(s,o){return e(o)}):n.prepare(m,"notification",i,function(s,o){return e(o)})})};let h=null,c=!1;async function E(){c&&(h!=null&&clearTimeout(h),n.stop(i),c=!1),c=!0,await n.play(i),setTimeout(function(){c=!1,n.stop(i),h=null},y)}function F(e){if(e.message.content&&e.channelId==f.getChannelId()&&!e.message.state&&e.sendMessageOptions==null){let s=(e.message.content.match(g)??[]).length;if(s+=(e.message.content.match(/<a?:.*?moy?ai.*?:.+?>/gi)??[]).length,s>0)for(let o=0;o<s;o++)setTimeout(E,o*350)}}function R(e){(t.storage.allowReactions??!0)&&e.channelId==f.getChannelId()&&(e.emoji.name==g||e.emoji.name.match(/.*?moy?ai.*?/i))&&!e.optimistic&&E()}let S=!1;var v={onLoad:function(){S||T().then(function(e){S=!0,y=e.duration}),a.FluxDispatcher.subscribe("MESSAGE_CREATE",F),a.FluxDispatcher.subscribe("MESSAGE_REACTION_ADD",R)},onUnload:function(){a.FluxDispatcher.unsubscribe("MESSAGE_CREATE",F),a.FluxDispatcher.unsubscribe("MESSAGE_REACTION_ADD",R)},settings:D};return l.default=v,Object.defineProperty(l,"__esModule",{value:!0}),l})({},vendetta.plugin,vendetta.metro,vendetta.metro.common,vendetta.storage,vendetta.ui.components);
